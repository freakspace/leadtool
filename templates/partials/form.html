
<div class="row" id="form-wrapper">
    <div id="error-alert" class="alert alert-danger alert-dismissible fade show" role="alert" style="display: none;">
        <span id="error-message"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    <form method="post" hx-post="{{ url_for('campaign', campaign_name=campaign) }}" hx-target="#form-wrapper" class="col my-4">

        <input type="text" class="form-control" name="id" id="id" value="{{ id }}" hidden>

        <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="text" class="form-control" name="email" id="email" value="{{ email }}">
        </div>

        <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input type="text" class="form-control" name="name" id="name" value="{{ name }}">
        </div>

        <div class="mb-3">
            <label for="link" class="form-label">Domain</label>
            <input type="text" class="form-control" name="link" id="link" value="{{ link }}">
        </div>

        <div class="mb-3">
            <label for="pronoun" class="form-label">Pronoun</label>
            <input type="text" class="form-control" name="pronoun" id="pronoun" value="i">
        </div>

        <div class="mb-3">
            <label for="area" class="form-label">Area</label>
            <input type="text" class="form-control" name="area" id="area" value="{{ city }}">
        </div>

        <div class="mb-3">
            <label for="campaign" class="form-label">Alternative campaign</label>
            <select name="campaign" class="form-select mt-3" aria-label="campaign-select">
                <option value="" selected></option>
                {% for campaign in campaigns %}
                <option value="{{ campaign.0 }}">{{ campaign.1 }}</option>
                {% endfor %}
            </select>
        </div>

        
        <button type="submit" name="action" value="accept" class="btn btn-success">Accept</button>
        <button type="submit" name="action" value="delete" class="btn btn-danger">Delete</button>

    </form>
    <div class="col">
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">Name</th>
                    <th scope="col">Data</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ID</td>
                    <td>{{ id }}</td>
                </tr>
                <tr>
                    <td>Name</td>
                    <td>{{ name }}</td>
                </tr>
                <tr>
                    <td>Industry</td>
                    <td>{{ industry }}</td>
                </tr>
                <tr>
                    <td>City</td>
                    <td>{{ city }}</td>
                </tr>
                <tr>
                    <td>Area</td>
                    <td>{{ area }}</td>
                </tr>
                <tr>
                    <td>Screenshot</td>
                    <td><img src="{{ url_for('static', filename=link + '.png') }}" class="img-fluid rounded"></td>
                </tr>
            </tbody>
        </table>
        <p>Leads count this campaign: {{campaign_count}}</p>
    </div>
</div>
<!-- HTMX script to handle JSON response and display the error message if present -->
<script>
    document.body.addEventListener('htmx:responseError', function(event) {
        var response = event.detail.xhr.response;
        try {
            var jsonResponse = JSON.parse(response);
            if (jsonResponse.message) {
                var errorAlert = document.getElementById('error-alert');
                var errorMessageDiv = document.getElementById('error-message');
                errorAlert.style.display = 'block';
                errorMessageDiv.innerText = jsonResponse.message;
            }
        } catch (e) {
            console.error('Could not parse JSON response', e);
        }
    });
    </script>